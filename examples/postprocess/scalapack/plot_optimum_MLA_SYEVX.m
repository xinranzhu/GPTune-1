close all
clear all
clc


lineColors = line_colors(5);
lineColors(2,:)=[0.8000    0.6667    0.4000];
lineColors(3,:)=[0.4000    0.8000    0.4000];




mcont = [3000:1:8000];
m3=mcont.^3/30000000000/1.44;


obj_single1= [[10.8]
[11.9]
[11.1]
[10.8]
[12.2]
[10.4]
[11.2]
[9.82]
[12.6]
[12.2]
[10.1]
[10.3]
[12.3]
[11.1]
[11.]
[11.2]
[11.7]
[13.]
[10.1]
[11.6]
[13.2]
[9.9]
[10.2]
[12.1]
[10.2]
[10.2]
[9.78]
[9.95]
[13.2]
[10.7]
[10.7]
[11.6]
[10.9]
[11.2]
[10.5]
[11.2]
[11.]
[10.4]
[10.9]
[12.9]
[10.8]
[10.8]
[12.9]
[12.1]
[13.]
[11.5]
[10.1]
[11.4]
[9.63]
[9.72]
[10.9]
[11.7]
[10.8]
[10.2]
[11.1]
[9.78]
[9.9]
[9.85]
[9.41]
[9.6]
[9.77]
[10.2]
[10.2]
[9.87]
[9.97]
[10.4]
[10.7]
[10.1]
[9.42]
[9.6]
[9.69]
[9.99]
[10.1]
[10.2]
[9.83]
[9.71]
[10.2]
[10.1]
[9.93]
[10.]
[10.1]
[11.2]
[10.1]
[10.1]
[10.5]
[10.7]
[10.7]
[9.77]
[10.5]
[9.77]
[10.1]
[10.1]
[9.42]
[9.59]
[11.3]
[10.2]
[10.2]
[10.]
[10.6]
[10.1]
[10.4]
[10.6]
[9.98]
[10.4]
[9.63]
[10.2]
[9.72]
[9.43]
[10.]
[10.1]
];

obj_single1=[sort(obj_single1(1:end/2,1));obj_single1(1+end/2:end,1)]



obj_single2=[
    [9.81]
[10.6]
[13.3]
[10.1]
[11.8]
[12.1]
[10.2]
[11.3]
[13.1]
[12.8]
[11.]
[11.5]
[10.1]
[11.7]
[11.7]
[10.1]
[10.7]
[12.4]
[12.]
[11.1]
[11.8]
[13.1]
[11.3]
[10.2]
[11.1]
[10.1]
[11.3]
[13.4]
[10.7]
[12.9]
[10.7]
[11.4]
[11.2]
[12.2]
[11.3]
[9.86]
[10.8]
[10.5]
[10.8]
[9.94]
[12.2]
[10.]
[10.]
[12.4]
[10.7]
[10.8]
[10.1]
[11.1]
[11.3]
[10.5]
[11.3]
[11.1]
[10.9]
[9.93]
[13.1]
[9.89]
[11.]
[11.5]
[13.1]
[12.]
[10.9]
[10.8]
[10.]
[10.1]
[11.3]
[11.9]
[10.2]
[11.4]
[11.9]
[11.1]
[11.]
[11.1]
[11.2]
[9.8]
[12.4]
[10.2]
[9.47]
[10.6]
[10.9]
[11.4]
[9.58]
[12.9]
[10.7]
[13.]
[10.6]
[10.1]
[11.3]
[11.1]
[10.3]
[12.]
[12.4]
[13.2]
[11.]
[10.]
[10.6]
[9.48]
[10.9]
[10.4]
[11.]
[10.1]
[9.89]
[11.1]
[10.2]
[11.2]
[11.]
[10.8]
[11.3]
[11.3]
[11.2]
[11.2]
[10.7]
[10.1]
[9.63]
[10.]
[10.7]
[10.1]
[9.92]
[9.69]
[10.5]
[10.7]
[10.5]
[9.8]
[10.2]
[10.2]
[10.5]
[10.6]
[10.2]
[10.1]
[10.9]
[10.7]
[9.56]
[10.5]
[10.6]
[10.6]
[10.7]
[10.2]
[9.79]
[10.]
[9.69]
[9.77]
[9.87]
[10.2]
[9.94]
[10.7]
[10.1]
[10.6]
[10.]
[10.1]
[10.2]
[9.73]
[10.1]
[9.91]
[9.95]
[9.88]
[9.43]
[9.72]
[9.98]
[9.74]
[9.79]
[10.]
[10.4]
[10.]
[10.5]
[10.1]
[9.66]
[9.69]
[10.1]
[9.45]
[10.2]
[9.99]
[10.2]
[10.2]
[10.6]
[9.83]
[10.]
[9.51]
[10.8]
[9.88]
[10.2]
[10.]
[9.97]
[9.59]
[10.]
[10.2]
[10.1]
[9.92]
[9.96]
[10.4]
[10.]
[10.7]
[10.1]
[9.77]
[9.78]
[10.1]
[10.]
[10.3]
[10.2]
[10.1]
[10.5]
[9.36]
[9.96]
[9.75]
[9.68]
[9.82]
[10.2]
[10.7]
[9.87]
[10.]
[9.99]
[9.4]
[10.1]
[10.5]
[10.4]
[9.94]
[9.78]
[10.5]
[9.81]
[10.5]
[9.57]
[9.92]
    ];
obj_single2=[sort(obj_single2(1:end/2,1));obj_single2(1+end/2:end,1)]


ntask=11;

obj_multi1=[
    [9.81]
[10.6]
[11.3]
[11.]
[9.86]
[9.85]
[10.]
[9.54]
[10.2]
[10.5]
    ];
obj_multi1=[sort(obj_multi1(1:end/2,1));obj_multi1(1+end/2:end,1)]



obj_multi_all1= [
    [0.84]
[0.891]
[0.963]
[0.715]
[0.96]
[1.4]
[1.22]
[1.17]
[1.1]
[1.59]
[1.56]
[1.5]
[1.83]
[1.8]
[1.57]
[2.36]
[2.15]
[3.19]
[2.56]
[2.23]
[2.96]
[2.9]
[2.74]
[3.09]
[2.91]
[3.87]
[3.88]
[4.04]
[3.91]
[4.89]
[4.86]
[5.02]
[5.64]
[5.55]
[6.84]
[9.32]
[9.56]
[8.7]
[9.3]
[9.32]
[9.81]
[10.6]
[11.3]
[11.]
[9.56]
[21.]
[22.6]
[22.7]
[23.]
[23.3]
[25.2]
[26.1]
[27.2]
[24.8]
[24.2]
[0.709]
[1.05]
[1.49]
[2.13]
[2.89]
[3.91]
[4.89]
[8.66]
[9.85]
[21.6]
[25.]
[0.881]
[1.07]
[1.47]
[2.31]
[2.85]
[3.89]
[5.13]
[8.93]
[10.]
[22.]
[25.1]
[0.709]
[1.06]
[1.47]
[2.14]
[2.72]
[3.89]
[5.37]
[8.42]
[9.84]
[21.5]
[25.]
[0.7]
[1.07]
[1.54]
[2.35]
[2.68]
[4.36]
[5.23]
[8.23]
[10.2]
[21.9]
[25.]
[0.693]
[1.05]
[1.55]
[2.31]
[2.69]
[4.08]
[4.93]
[9.17]
[10.5]
[21.9]
[25.5]
];



obj_multi2=[
[9.87]
[11.]
[11.2]
[11.1]
[9.92]
[11.2]
[12.9]
[10.8]
[9.72]
[12.1]
[11.4]
[10.2]
[9.63]
[9.91]
[10.]
[9.7]
[10.1]
[11.2]
[10.8]
[9.85]
    ];
obj_multi2=[sort(obj_multi2(1:end/2,1));obj_multi2(1+end/2:end,1)]



obj_multi_all2= [
   

[0.663]
[0.724]
[0.869]
[1.13]
[0.687]
[0.846]
[0.695]
[0.715]
[0.941]
[0.702]
[1.09]
[1.44]
[1.07]
[1.42]
[1.18]
[1.33]
[1.23]
[1.46]
[1.29]
[1.22]
[1.94]
[2.23]
[1.76]
[2.22]
[1.49]
[1.56]
[1.83]
[1.49]
[1.56]
[1.66]
[2.33]
[3.2]
[2.41]
[2.13]
[2.13]
[2.58]
[2.53]
[2.7]
[2.35]
[2.56]
[3.91]
[2.69]
[2.72]
[3.16]
[3.56]
[3.09]
[2.68]
[2.91]
[2.74]
[3.17]
[3.88]
[5.42]
[4.11]
[4.58]
[4.88]
[4.36]
[5.46]
[4.12]
[4.05]
[4.88]
[5.01]
[5.6]
[5.01]
[5.89]
[5.15]
[5.17]
[6.46]
[5.91]
[5.46]
[5.15]
[9.55]
[11.1]
[9.7]
[8.69]
[9.81]
[11.1]
[9.57]
[9.31]
[11.5]
[9.08]
[9.87]
[11.]
[11.2]
[11.1]
[9.92]
[11.2]
[12.9]
[10.8]
[9.72]
[12.1]
[22.4]
[21.8]
[26.1]
[22.9]
[23.4]
[21.9]
[21.7]
[25.9]
[22.2]
[23.2]
[26.8]
[25.8]
[29.7]
[25.3]
[26.2]
[26.4]
[27.7]
[25.]
[27.]
[26.]
[0.693]
[1.1]
[1.49]
[2.24]
[2.83]
[4.09]
[4.88]
[8.5]
[11.4]
[22.1]
[25.1]
[0.821]
[1.1]
[1.55]
[2.25]
[2.68]
[3.87]
[5.14]
[8.86]
[10.2]
[22.1]
[24.1]
[0.687]
[1.19]
[1.49]
[2.26]
[2.86]
[3.9]
[5.13]
[8.89]
[9.63]
[21.8]
[24.8]
[0.701]
[1.05]
[1.5]
[2.14]
[2.71]
[3.89]
[4.93]
[8.47]
[9.91]
[22.1]
[23.9]
[0.979]
[1.06]
[1.54]
[2.27]
[2.83]
[3.94]
[4.92]
[8.89]
[10.]
[21.7]
[24.8]
[0.711]
[1.06]
[1.46]
[2.15]
[2.69]
[3.89]
[4.94]
[8.99]
[9.7]
[22.3]
[25.8]
[0.697]
[1.06]
[1.47]
[2.13]
[2.71]
[3.9]
[5.]
[8.68]
[10.1]
[21.8]
[24.4]
[0.736]
[1.11]
[1.51]
[2.12]
[2.83]
[3.89]
[4.97]
[8.54]
[11.2]
[21.6]
[25.]
[0.708]
[1.12]
[1.46]
[2.13]
[2.73]
[3.9]
[4.91]
[8.5]
[10.8]
[21.8]
[24.]
[0.891]
[1.08]
[1.49]
[2.11]
[2.7]
[3.9]
[4.97]
[8.88]
[9.85]
[21.8]
[24.5]
 
];


obj = ones(ntask,2);
obj_rand = ones(ntask,1);
for jj=1:ntask
tmp=zeros(length(obj_multi_all1)/ntask,1);
for ii=1:length(tmp)/2
tmp(ii) = obj_multi_all1((jj-1)*length(tmp)/2+ii,1) ; 
end
obj_rand(jj)=min(tmp(1:length(tmp)/2));
for ii=1:length(tmp)/2
tmp(ii+length(tmp)/2) = obj_multi_all1(length(obj_multi_all1)/2+(ii-1)*ntask+jj,1); 
end

obj(jj,1)=min(tmp);
obj(jj,2)=max(tmp);
end






obj1 = ones(ntask,2);
obj_rand1 = ones(ntask,1);
for jj=1:ntask
tmp=zeros(length(obj_multi_all2)/ntask,1);
for ii=1:length(tmp)/2
tmp(ii) = obj_multi_all2((jj-1)*length(tmp)/2+ii,1) ;   
end
obj_rand1(jj)=min(tmp(1:length(tmp)/2));
for ii=1:length(tmp)/2
tmp(ii+length(tmp)/2) = obj_multi_all2(length(obj_multi_all2)/2+(ii-1)*ntask+jj,1); 
end
obj1(jj,1)=min(tmp);
obj1(jj,2)=max(tmp);
end



m = [3000 3500 4000 4500 5000 5500 6000 6500 7000 7500 8000];
m_single = [ 7000];
opt_single = [ 9.41];




m1 = [3000 3500 4000 4500 5000 5500 6000 6500 7000 7500 8000];
m_single1 = [ 7000];
opt_single1 = [ 9.36];

%% Plot figure 1
axisticksize = 48;
origin = [200,60];
markersize = 14;
LineWidth = 5;




figure(1)
barsize=14;
hd1=errorbar(m,obj(:,1),[],obj(:,2)-obj(:,1),'o','MarkerSize',markersize,'MarkerFaceColor',[lineColors(3,:)],'LineWidth',LineWidth,'Color',[lineColors(3,:)]);
hd1.CapSize = barsize;
hold on
hd1=errorbar(m*1.008,obj1(:,1),[],obj1(:,2)-obj1(:,1),'o','MarkerSize',markersize,'MarkerFaceColor',[lineColors(1,:)],'LineWidth',LineWidth,'Color',[lineColors(1,:)]);
hold on
hd1.CapSize = barsize;
hd1=errorbar(m_single*1.008^2,min(obj_single1(:)),[],max(obj_single1(:))-min(obj_single1(:)),'o','MarkerSize',markersize,'MarkerFaceColor',[lineColors(2,:)],'LineWidth',LineWidth,'Color',[lineColors(2,:)]);
hold on
hd1.CapSize = barsize;
hd1=errorbar(m_single1*1.008^3,min(obj_single2(:)),[],max(obj_single2(:))-min(obj_single2(:)),'o','MarkerSize',markersize,'MarkerFaceColor',[lineColors(4,:)],'LineWidth',LineWidth,'Color',[lineColors(4,:)]);
hold on
hd1.CapSize = barsize;
hd1 = plot(mcont,m3,'--k','MarkerSize',markersize,'MarkerFaceColor','k','LineWidth',LineWidth);
hold on
% hd1 = plot(mcont,m3*2.5,'--k','MarkerSize',markersize,'MarkerFaceColor','k','LineWidth',LineWidth);
% hold on

% hd1=plot(m,obj_rand,'x','MarkerSize',markersize,'MarkerFaceColor','k','LineWidth',LineWidth,'Color','k');
% hold on
% hd1=plot(m*1.008,obj_rand1,'x','MarkerSize',markersize,'MarkerFaceColor','k','LineWidth',LineWidth,'Color','k');
% hold on



set(gca, 'XScale','log', 'YScale','log')

% mlin = linspace(0,5000,100);
% nlin = linspace(0,5000,100);
% [M,N]=meshgrid(mlin,nlin);
% Z = griddata(m,n,opt,M,N,'cubic');
% mesh(M,N,Z,'FaceAlpha',0.5);
% hold on;



gca = get(gcf,'CurrentAxes');
set(gca,'YTick',[1 2 5 10 20 25 ])
% set(gca,'TickLabelInterpreter','none')
% xticklabels(xtick)
% xtickangle(45)
xlim([3000,7300]);
% ylim([0,2000]);


legs = {};
legs{1,1} = ['$\delta=9$, $\epsilon_{tot}=10$'];
legs{1,2} = ['$\delta=9$, $\epsilon_{tot}=20$'];
legs{1,3} = ['$\delta=1$, $\epsilon_{tot}=90$'];
legs{1,4} = ['$\delta=1$, $\epsilon_{tot}=180$'];
legs{1,5} = ['$O(m^3)$'];

gca = get(gcf,'CurrentAxes');
set( gca, 'FontName','Times New Roman','fontsize',axisticksize);
str = sprintf('runtime ($s$)');
ylabel(str,'interpreter','Latex')
str = sprintf('$m$');
xlabel(str,'interpreter','Latex')
str = sprintf('time (s)');
zlabel(str,'interpreter','Latex')


gca=legend(legs,'interpreter','Latex','color','none','NumColumns',1,'Location','northwest');
legend('boxoff')
set(gcf,'Position',[origin,1000,700]);

fig = gcf;

str = 'scalapack_syevx_MLA_optimum_time.eps';
saveas(fig,str,'epsc')



