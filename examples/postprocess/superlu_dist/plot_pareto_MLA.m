close all
clear all
clc

%% search_more_samples = 16
% 
% opt1 = {};
% opt1{1} = [[0.07235512137413025, 2259.556640625]; [0.08312955498695374, 785.9321899414062]; [0.14813558757305145, 83.76930236816406]; [0.10281873494386673, 103.99976348876953]; [0.14582742750644684, 92.21307373046875]; [0.15099439024925232, 82.3497543334961]];
% opt1{2} = [[0.4119759798049927, 374.67584228515625]; [0.28571608662605286, 455.3668518066406]; [0.2803134620189667, 812.8123779296875]; [0.27977994084358215, 838.3776245117188]];
% opt1{3} = [[0.41696372628211975, 402.18499755859375]; [0.3255928158760071, 557.19091796875]; [8.393198013305664, 330.009521484375]; [8.393815040588379, 325.1853942871094]; [10.851630210876465, 283.5483703613281]];
% opt1{4} = [[0.6370441913604736, 300.48748779296875]; [0.37347865104675293, 544.2279663085938]; [0.3765798509120941, 488.4475402832031]; [0.5353922843933105, 302.62701416015625]; [0.3028181791305542, 4382.32275390625]; [0.3133121430873871, 1028.637939453125]; [0.331685870885849, 978.7471313476562]];
% opt1{5} = [[0.48911023139953613, 627.15380859375]; [0.33848822116851807, 745.7210693359375]; [1.9767539501190186, 514.8040771484375]; [3.6961092948913574, 513.400390625]];
% opt1{6} = [[0.7358484864234924, 2398.91455078125]; [0.780238926410675, 1584.237060546875]; [7.046725273132324, 1154.14990234375]];
% opt1{7} = [[1.10593843460083, 1551.468017578125]; [1.1712502241134644, 1483.829833984375]];
% opt1{8} = [[10.18563175201416, 2725.482177734375]; [2.940619707107544, 3885.08056640625]; [3.096311330795288, 3334.4814453125]; [2.1032700538635254, 4150.60009765625]];
% for ii=1:length(opt1)
%     [tmp,I] = sort(opt1{ii}(:,1));
%     opt1{ii}=opt1{ii}(I,:);
% end
% 
% opt2 = {};
% opt2{1} = [[0.11509640514850616, 148.15426635742188]; [0.08346901834011078, 785.9321899414062]; [0.1484357863664627, 102.26907348632812]; [0.08839284628629684, 215.5799102783203]];
% opt2{2} = [[0.39695805311203003, 374.67584228515625]; [0.28384989500045776, 455.3668518066406]; [0.596204936504364, 274.48492431640625]; [0.5774547457695007, 290.04669189453125]; [0.5896357297897339, 289.20831298828125]; [0.6419796943664551, 264.140380859375]; [0.5602962970733643, 292.6793212890625]; [0.8849730491638184, 225.06326293945312]];
% opt2{3} = [[0.43640244007110596, 402.18499755859375]; [0.3105461895465851, 557.19091796875]];
% opt2{4} = [[0.29185760021209717, 1359.1165771484375]; [0.43082258105278015, 688.6373901367188]; [0.3020806908607483, 819.1072998046875]; [0.4300386607646942, 800.860107421875]];
% opt2{5} = [[0.4356953799724579, 5246.650390625]; [0.47937899827957153, 2489.73876953125]; [0.439430832862854, 3009.07958984375]; [0.49267128109931946, 2005.8187255859375]; [1.5124082565307617, 239.400146484375]; [0.5192438960075378, 390.88641357421875]; [0.5685200691223145, 300.9195556640625]; [2.3213024139404297, 228.5429229736328]; [1.7718498706817627, 229.46823120117188]; [0.4948984682559967, 521.5704345703125]];
% opt2{6} = [[0.7820054292678833, 1076.266357421875]; [0.6924444437026978, 1076.916748046875]; [0.6446826457977295, 1162.578125]; [0.8510522246360779, 1030.880859375]];
% opt2{7} = [[1.298940896987915, 3913.089599609375]; [1.4516702890396118, 2031.6751708984375]; [1.140491247177124, 4385.27099609375]; [1.490700125694275, 1715.81982421875]];
% opt2{8} = [[8.777597427368164, 2725.482177734375]; [2.2871289253234863, 3404.001953125]];
% for ii=1:length(opt2)
%     [tmp,I] = sort(opt2{ii}(:,1));
%     opt2{ii}=opt2{ii}(I,:);
% end

 
%% search_more_samples = 4
opt1 = {};
opt1{1} = [[0.08640700578689575, 2259.556640625]; [0.08649016916751862, 785.9321899414062]; [0.12265041470527649, 89.37596130371094]; [0.09520558267831802, 100.9891357421875]; [0.15594322979450226, 33.040863037109375]];
opt1{2} = [[0.40410754084587097, 374.67584228515625]; [0.22261130809783936, 455.3668518066406]; [1.9127625226974487, 115.72838592529297]; [1.486739158630371, 124.46957397460938]; [0.319536030292511, 376.0336608886719]; [0.4097842574119568, 344.4443054199219]];
opt1{3} = [[0.4243587255477905, 402.18499755859375] ; [0.3190632462501526, 557.19091796875] ; [0.29700767993927, 3375.96142578125] ; [1.9134430885314941, 139.93222045898438] ; [0.43200603127479553, 181.03134155273438] ; [0.5233200192451477, 166.8052520751953]; [0.34723159670829773, 521.6184692382812]; [0.27347615361213684, 5477.828125]];
opt1{4} = [[0.4119970500469208, 352.4343566894531]; [0.39349159598350525, 365.2168273925781]; [8.145922660827637, 276.1435546875]; [11.638938903808594, 153.4582977294922]; [8.732651710510254, 157.6747589111328]; [0.37083518505096436, 624.9811401367188]; [0.30747732520103455, 727.0609741210938]];
opt1{5} = [[2.0767054557800293, 318.1478271484375]; [25.88448143005371, 214.8919677734375]; [17.663610458374023, 226.1696014404297]; [0.3733220398426056, 522.7496337890625]];
opt1{6} = [[0.7358484864234924, 2398.91455078125]; [0.780238926410675, 1584.237060546875]; [7.046725273132324, 1154.14990234375]];
opt1{7} = [[0.7593953013420105, 2398.91455078125]; [2.114954710006714, 1684.2205810546875]; [2.619971752166748, 1669.5914306640625]; [4.887787818908691, 915.053955078125]; [3.583285331726074, 1155.194580078125]; [8.276792526245117, 740.8499755859375]; [8.112486839294434, 742.7686157226562]; [0.7643425464630127, 1684.563232421875]];
opt1{8} = [[10.198590278625488, 2725.482177734375]; [13.980320930480957, 2414.1767578125]; [18.722576141357422, 2412.332763671875]; [25.42148208618164, 2063.064208984375]; [21.082626342773438, 2070.994873046875]; [3.007955551147461, 2939.3125]; [1.751509132385254, 7910.7724609375]];
for ii=1:length(opt1)
    [tmp,I] = sort(opt1{ii}(:,1));
    opt1{ii}=opt1{ii}(I,:);
end
opt2 = {};
opt2{1} = [[0.11509640514850616, 148.15426635742188]; [0.08346901834011078, 785.9321899414062]; [0.1484357863664627, 102.26907348632812]; [0.08839284628629684, 215.5799102783203]];
opt2{2} = [[0.40310022234916687, 374.67584228515625]; [0.2928388714790344, 455.3668518066406]; [0.552886426448822, 303.0956726074219]; [0.6139572858810425, 300.7619934082031]; [0.7581754326820374, 237.35618591308594]; [0.2903648912906647, 2852.096435546875]];
opt2{3} = [[0.44034644961357117, 402.18499755859375]; [0.32183611392974854, 557.19091796875]; [0.2840871512889862, 3375.96142578125]; [0.4506702721118927, 175.03335571289062]; [1.9214575290679932, 147.67503356933594]; [0.36402246356010437, 516.4365844726562]; [0.2869489789009094, 1101.195556640625]];
opt2{4} = [[0.2650053799152374, 525.031494140625]];
opt2{5} = [[0.5288020372390747, 627.15380859375]; [2.9654171466827393, 258.4732360839844]; [2.602203130722046, 276.6289367675781]; [0.5985876321792603, 546.674560546875]; [0.3421170711517334, 1302.21875]; [0.44844764471054077, 1206.5682373046875]];
opt2{6} = [[0.7709342837333679, 2398.91455078125]; [1.092940330505371, 1709.643798828125]];
opt2{7} = [[1.518563151359558, 1715.81982421875]; [1.1630477905273438, 2627.721923828125]; [15.67312240600586, 1610.0709228515625]; [10.492384910583496, 1621.682861328125]];
opt2{8} = [[10.2185640335083, 2725.482177734375]; [1.8945618867874146, 4769.08837890625]; [2.0054094791412354, 3699.254150390625]; [2.4355502128601074, 3181.98681640625]];
for ii=1:length(opt2)
    [tmp,I] = sort(opt2{ii}(:,1));
    opt2{ii}=opt2{ii}(I,:);
end


%% Plot figure 1
axisticksize = 40;
origin = [200,60];
markersize = 14;
LineWidth = 3;
lineColors = line_colors(10);
lineColors(3,:)=lineColors(9,:);
lineColors(5,:)=[0 0 0];


figure(1)
for ii=1:length(opt1)
hd3 = loglog(opt1{ii}(:,1),opt1{ii}(:,2),'-o','MarkerSize',markersize,'MarkerFaceColor',[lineColors(ii,:)],'LineWidth',LineWidth,'Color',[lineColors(ii,:)]);
hold on
hd3 = loglog(opt2{ii}(:,1),opt2{ii}(:,2),'--*','MarkerSize',markersize,'MarkerFaceColor',[lineColors(ii,:)],'LineWidth',LineWidth,'Color',[lineColors(ii,:)]);
hold on
end


% hd1 = loglog(opt1(:,1),opt1(:,2),'o','MarkerSize',markersize,'MarkerFaceColor',[lineColors(2,:)],'LineWidth',LineWidth,'Color',[lineColors(2,:)]);
% hold on
% hd2 = loglog(opt2(:,1),opt2(:,2),'o','MarkerSize',markersize,'MarkerFaceColor',[lineColors(6,:)],'LineWidth',LineWidth,'Color',[lineColors(6,:)]);
% hold on
% hd1 = loglog(default(:,1),default(:,2),'co','MarkerSize',markersize,'MarkerFaceColor',[lineColors(4,:)],'LineWidth',LineWidth,'Color',[lineColors(4,:)]);
% hold on


gca = get(gcf,'CurrentAxes');
set(gca,'YTick',[25 50, 100, 200, 400, 800, 1600, 3200, 6400])
set(gca,'XTick',[0.1, 0.25,0.5,1,2,4, 8, 16, 32])

% set(gca,'TickLabelInterpreter','none')
% xticklabels(xtick)
% xtickangle(45)
xlim([0.07,26]);
ylim([32,7950]);


legs = {};
legs{1,1} = ['Si2-MLA'];
legs{1,2} = ['Si2'];
legs{1,3} = ['SiH4-MLA'];
legs{1,4} = ['SiH4'];
legs{1,5} = ['SiNa-MLA'];
legs{1,6} = ['SiNa'];
legs{1,7} = ['Na5-MLA'];
legs{1,8} = ['Na5'];
legs{1,9} = ['benzene-MLA'];
legs{1,10} = ['benzene'];
legs{1,11} = ['Si10H16-MLA'];
legs{1,12} = ['Si10H16'];
legs{1,13} = ['Si5H12-MLA'];
legs{1,14} = ['Si5H12'];
legs{1,15} = ['SiO-MLA'];
legs{1,16} = ['SiO'];


gca = get(gcf,'CurrentAxes');
set( gca, 'FontName','Times New Roman','fontsize',axisticksize);
str = sprintf('Memory (MB)');
ylabel(str,'interpreter','Latex')
str = sprintf('Time (s)');
xlabel(str,'interpreter','Latex')

gca=legend(legs,'interpreter','none','color','none','NumColumns',4,'Location','SouthEast');
gca.FontSize = 22;

set(gcf,'Position',[origin,1000,700]);

fig = gcf;

str = 'pareto_superlu_MLA.eps';
saveas(fig,str,'epsc')

